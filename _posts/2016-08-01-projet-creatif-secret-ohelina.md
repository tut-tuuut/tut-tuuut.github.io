---
layout: post
title: "Organiser une chasse au trésor à un mariage"
category: geekerie jeu
tags: 
excerpt: "PCS #17 - nom de code Ohélina"
---

À la toute fin du mois de juillet, j'ai été témoin au mariage d'un bon ami avec sa belle chérie. Cet ami étant un gros geek et un compagnon de jeu de longue date, il m'avait demandé ce que je pensais d'une idée qui sortait de l'ordinaire : remplacer les traditionnelles animations de repas de mariage par une sorte de jeu de piste ou de chasse au trésor. J'en pensais tellement de bien que je me suis lancée à peu près aussitôt dans la réalisation du truc. Je vous livre ici un retour d'expérience au cas où vous voudriez faire pareil (et aussi pour moi, au cas où je voudrais recommencer).

En résumé : je me suis beaucoup amusée mais j'ai pas beaucoup dormi.

## Un mariage

On a dès le début imaginé le principe suivant :

* chaque énigme, une fois résolue, pointe vers une *personne* qui est un complice du jeu et qui donne l'énigme suivante ainsi qu'un petit carton révélant un bout de l'histoire des mariés,
* si des indices sont disponibles dans la salle, ils sont *discrets* et *inamovibles*.

Plusieurs raisons à ce choix :

* un public d'invités de mariage est hétéroclite : tout le monde ne veut pas jouer (donc pas la peine de pourrir la déco outre mesure) et l'alcool tend à rendre les gens plaisantins (c'est-à-dire enclins à décoller des bouts de papiers intrigants) ;
* on n'a pas forcément beaucoup de temps ni d'informations (type plan ou photos) pour préparer le jeu de piste sur place (coller des indices, cacher des éléments…)

## Ce mariage

Quelques difficultés supplémentaires propres à ce mariage en particulier sont venues pimenter la conception et l'organisation du jeu :

1. la moitié de l'assemblée était Finnoise et ne parle pas un mot de français,
2. l'autre moitié de l'assemblée était Française et ne parle pas un mot de finnois,
3. les mariés habitent à Helsinki,
4. j'ai une fille de deux ans et demi environ qui est très demandeuse d'attention,
5. j'ai une fille de zéro ans et demi environ qui est très demandeuse de mes nichons.

C'est là qu'on se dit que le projet commence à être ambitieux. Tant pis, je me suis lancée. :D

## Organisation et réalisation

La conception des énigmes a pris environ deux mois en régime réduit (cf. difficultés n°4 et n°5) avec une accélération du rythme à la fin. J'ai tout mis en page sur Apple pages qui était le logiciel de traitement de texte le plus stable que j'avais à disposition (Libre Office fait parfois des BSOD sur mon nordi, j'avais pas envie).

Une semaine avant le mariage, j'ai fait tester trois énigmes un peu complexes à des cobayes (mon petit frère et sa copine) pour vérifier qu'il n'y avait pas de souci. Il y en avait. J'ai bien fait.

Je comptais imprimer les énigmes à la COREP (pas cher pas cher, 3 centimes la page) mais à cause de difficultés d'organisation, j'ai partagé les impressions entre une imprimante perso et un imprimeur bien plus cher, pendant la semaine précédant immédiatement le mariage. Il y a aussi certains bouts d'énigmes que j'ai écrits à la main. (Pas ceux qu'il fallait en 15 exemplaires, heureusement !)

La veille du mariage, j'ai également préparé les cartons « récompense » en découpant et collant les bouts de l'histoire des mariés sur des photos du couple. Dans la foulée je les ai mis dans des enveloppes avec les papiers contenant les textes des énigmes. J'ai fini à 3h30 du matin. Hum. Notes pour plus tard : utiliser un massicot et faire tout ce qui est faisable largement à l'avance.

J'ai scotché une partie des indices dans la salle la veille du mariage, avec bébé dans le porte-bébé. Une partie était également intégrée dans le trombinoscope des invités conçu par les mariés. (On envisageait aussi d'en cacher certains dans les menus, mais tout le monde était beaucoup trop à l'arrache pour ça.) J'ai scotché la fin des indices dans la salle… au début du vin d'honneur. LARGE !


## Déroulement du jeu

À la fin du vin d'honneur, j'ai écrit et accroché un petit panneau « vous voulez jouer ? Allez parler au témoin qui a le plus de filles… » avec la traduction en anglais (je n'avais pas de Finlandais sous la main pour la traduction en finnois). Cela constituait une première énigme assez soft pour entraîner les joueurs à chercher un peu. On a évité de faire une annonce : c'était beaucoup plus amusant de laisser traîner des indices mystérieux dans la salle et de piquer ainsi l'attention des invités.

J'ai également confié à chaque « complice » un paquet de 15 enveloppes identiques, en leur reprécisant le mot de passe qui leur correspondait. (Natacha, qui était pointée par l'énigme n°2, portait l'énoncé de l'énigme n°3.) J'ai réexpliqué le principe du jeu, et bien insisté sur le fait qu'ils pouvaient jouer aussi : ils connaissaient un mot de passe, mais ils ne savaient pas de quelle énigme ils étaient la solution, ni à quel niveau du jeu leur énigme se situait.

Ensuite, j'ai attendu que le jeu se lance. Quelques invités ont vu le panneau et sont venus me trouver. Je leur ai expliqué et je leur ai donné l'enveloppe contenant la première énigme. Ensuite, d'autres invités ont vu les premiers joueurs et leur ont demandé où ils avaient trouvé le jeu, et de fil en aiguille une dizaine d'équipes d'horizons divers se sont lancées sur la piste.

Par la suite, je suis restée à disposition des joueurs pour les aider en cas de problème ou pour être prête en cas de bug. Du moins, jusqu'à ce que j'essaie d'endormir mon bébé à l'hôtel et que je m'endorme par la même occasion. Heureusement, le gros bug de la troisième énigme a été découvert et contourné avant que je m'endorme en sursaut.

Aux dernières nouvelles, seules deux équipes sont arrivées au bout de la dernière énigme. Il semble que le soufflé soit retombé quand le dancefloor a commencé à s'enflammer.

## Difficultés rencontrées

En concevant les énigmes, j'ai surtout eu du mal à doser la difficulté. J'ai aussi constaté en « lâchant » les joueurs sur mes énigmes que les difficultés n'étaient pas du tout où je le pensais. (Détails plus bas dans la liste des énigmes.)

J'ai pondu une énigme (sur 9) complètement insoluble à cause d'un accident de mise en page à 1 ou 2 heures du matin. Note pour plus tard : vérifier la mise en page une fois que le jour est levé.

Et enfin, contrairement à d'autres, je parle beaucoup moins bien les langues étrangères quand je suis fatiguée ou alcoolisée. (Big up à mon mari qui parle très bien japonais quand il est bourré !) Cela complique la communication avec les joueurs finlandais quand la nuit est tombée.

Si c'était à refaire, je prendrais également un bon baby-sitter pour les mois de conception et pour le soir du mariage : trop compliqué de faire travailler les neurones à côté d'un bébé qui braille, et trop dur physiquement de surveiller 2 gamines en bas âge en même temps qu'une troupe de joueurs enthousiastes.

## Les énigmes

### Nuit étoilée

Je cherchais un moyen pour les Finnois et les Français de « briser la glace ». J'ai donc imaginé cette énigme où il faut relier les mots en français avec leur équivalent en finnois. Les traits forment le prénom du complice, le mot isolé est le mot de passe.

![](/img/2016/mariage/stars.jpg)

Pour cette énigme j'ai choisi le complice en fonction des lettres composant son prénom : il me fallait beaucoup de lignes droites. Il y avait juste un « C » que j'avais du mal à former avec ce système. Je ne sais plus à quel moment j'avais ajouté les étoiles, mais au final elles m'arrangeaient bien : j'ai ajouté la lune pour former le C. Ce qui ressemblait à de la déco se révélait au final être un bout de la solution. :)

Cette énigme, placée plutôt au début du jeu, a très bien marché pour faire discuter les francophones et les… euh… finnoiphones ? Tous les joueurs que j'ai vus jouaient le jeu, je n'ai attrapé personne sur google translate en 3G. En outre je suis très satisfaite du rendu visuel, j'aime beaucoup les étoiles qui forment des constellations bizarres.

### Été indien à Kuusamo

La chanson _L'été Indien_ de Joe Dassin a été reprise en finnois par un artiste Finlandais, et elle ne parle pas _du tout_ de la même chose. J'ai voulu caser cela dans une énigme, mais comment ? Je me suis souvenue d'un épisode de Sherlock où il est question d'un message codé à l'aide d'un livre via un procédé appelé _book cipher_. À la place d'un livre, j'ai utilisé les paroles comme code de base pour cacher un message dedans. (Ne googlez pas si vous voulez tester l'énigme.)

J'ai ajouté une couche de mystère en utilisant des vieux chiffres indiens à la place de ces chers chiffres arabes. Il y avait donc ces messages dans la salle :

![](/img/2016/mariage/msg-fi.png)

Ainsi que les paroles des chansons, accrochées aux toilettes :

![](/img/2016/mariage/ete-indien.png)

![](/img/2016/mariage/kuusmao.png)

Et les participants disposaient de ceci dans leur enveloppe :

![](/img/2016/mariage/ete-indien-a-kuusamo.png)

Si vous êtes inconditionnel(le) de Joe Dassin, vous remarquerez que j'ai modifié légèrement les paroles de la chanson française pour coller à mes besoins. Une équipe de jeunes technophiles qui avait pris la version originale sur Google a donc eu un peu de mal.

Quant à la version finnoise, eh bien… Vu que j'avais passé le texte sur 2 colonnes, certains vers ont été coupés sur deux lignes… Donc toute la numérotation dont dépendait l'énigme était cassée dès la ligne 5 ou 6. OUPS. Nous nous sommes contentés d'écrire en gros le nom et le prénom de la personne « complice ».

Pour cette énigme, j'avais peur que le système de codage soit trop obscur et que les joueurs restent coincés, ne sachant que faire. Finalement, elle a très bien fonctionné. La difficulté était juste assez bien dosée pour que la récompense soit accessible sans être donnée toute cuite.

En tout cas, même si l'énigme était insoluble, c'était très amusant de voir des groupes hétéroclites de joueurs s'amasser aux toilettes pour compter les vers de chansons à la noix.

### Sudoku itinérant

Comme on ne voulait pas faire que des énigmes de type « cahier d'activités » ainsi que mon cher marié les a désignées, j'ai mijoté quelques énigmes qui obligeraient les joueurs à fouiner et à ouvrir l'œil.

C'est comme ça que je me suis retrouvée à scotcher un peu partout les morceaux d'une grille de sudoku soigneusement choisie.

![](/img/2016/mariage/sudoku1.png)

Comment cache-t-on un message dans une grille de sudoku ? Fastoche, en associant une lettre à chaque chiffre ! On peut également proposer une grille contenant uniquement les lettres, mais cela nécessite que le message contienne 9 lettres distinctes. Et je n'avais aucun invité dont le prénom était constitué de 9 lettres distinctes.

![](/img/2016/mariage/sudoku2.png)

Comment cache-t-on _deux_ messages dans une grille de sudoku ? Fastoche, il suffit que le deuxième message soit un anagramme du premier… et que la grille de sudoku soit bien fichue.

Pour obtenir un anagramme du prénom de mon complice, j'ai utilisé anagramme.org, un site fort utile (probablement initialement destiné aux joueurs de Scrabble).

Pour obtenir une grille « bien fichue », j'ai un peu plus galéré déjà. (Euphémisme.)

J'avais téléchargé des cahiers de sudoku en PDF, contenant des grilles et les solutions dans un format copiable-collable au format texte.

J'ai commencé par faire les remplacements avec mon éditeur de texte avant de chercher avec mes petits yeux si je voyais quelque part l'annagrame recherché. Ça faisait 18x9 rechercher-remplacer pour une seule grille, et mes petits yeux ne trouvaient pas grand-chose vu que mon heure théorique de coucher était largement dépassée.

Alors j'ai fait plus efficace (et franchement moins fatigant si vous voulez mon avis) : j'ai écrit un programme qui analyse les solutions à la recherche d'une grille contenant les deux anagrammes que je voulais.

C'est la première fois que j'utilise un algorithme de recherche « en profondeur d'abord » pour résoudre un vrai problème, hors du contexte d'un exercice de cours ou d'un entretien d'embauche. Je vous livre ici le cœur de l'analyse (un terme simple pour désigner les 15 lignes vaguement élégantes d'un fichier qui en compte 175).

{% highlight php %}
// $i et $j (entiers) = position horizontale et verticale du curseur ds le sudoku
// $index (entier) = position dans le terme de recherche
// $graph (tableau) = grille du sudoku
// $search (chaîne de caractères) = terme recherché
// $direction (entier 0, 1 ou 2) = direction dans laquelle on cherche
function analyse_char($i, $j, $index, $graph, $search, $direction) {
    if ($i > 8 || $j > 8) {
        return;
    }

    if ($graph[$i][$j] == $search[$index]) {
        if ($index === strlen($search) - 1) {
            echo "found $search !!!".PHP_EOL;
            display_anagramme($graph);
            return true;
        }
        if ($direction === 0 || $direction === 1) {
            // on cherche verticalement
            analyse_char($i+1, $j, $index + 1, $graph, $search, 1);
        }
        if ($direction === 0 || $direction === 2) {
            // on cherche horizontalement
            analyse_char($i, $j+1, $index + 1, $graph, $search, 2);
        }
    }
}
{% endhighlight %}

Si vous voulez voir le programme en entier, [je vous en prie](/img/2016/mariage/solution-cherchons.php). Il y a pas mal de code pour construire des tableaux à partir de la solution copiée-collée depuis mon PDF, ensuite du code pour rechercher-remplacer les chiffres par la grille de correspondance désirée (bonus j'ai galéré en UTF8 et j'ai pas cherché à comprendre) et finalement la recherche elle-même dans la grille de lettres.

En bonne victime du syndrome de l'imposteur, j'ai envie de cacher la source de ce programme parce qu'elle est « moche », probablement trop verbeuse par endroits et pas assez à d'autres, mal optimisée côté CPU et conso mémoire. Peut-être qu'elle ne passerait aucune revue de code, mais elle est _vraie_. Je sais qu'elle fonctionne.

Donc je vous l'offre. Si jamais vous avez envie de cacher des anagrammes dans un sudoku, sait-on jamais… ou si vous voulez vous décomplexer un peu. Vous n'êtes pas lela seul(e) à écrire du code moche et jetable !

(Dans quelques semaines, je donne une conférance à Paris Web sur le sujet du syndrome de l'imposteur… donc je travaille assez fort sur le mien ces temps-ci.)

